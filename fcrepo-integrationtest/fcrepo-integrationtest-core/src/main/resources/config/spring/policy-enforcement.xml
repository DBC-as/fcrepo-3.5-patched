<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd">
        <bean id="org.fcrepo.security.ContextRegistry" class="org.fcrepo.server.security.impl.HashtableContextRegistry" />
        <bean id="org.fcrepo.server.security.ContextAttributeFinderModule"
              class="org.fcrepo.server.security.ContextAttributeFinderModule"
              autowire-candidate="true">
              <constructor-arg><ref bean="org.fcrepo.security.ContextRegistry" /></constructor-arg>
        </bean>
        <bean id="org.fcrepo.server.security.ResourceAttributeFinderModule"
              class="org.fcrepo.server.security.ResourceAttributeFinderModule"
              factory-method="getInstance" autowire-candidate="true">
              <property name="legacyConfiguration">
                <ref bean="org.fcrepo.server.security.AuthorizationConfiguration" />
              </property>
              <property name="DOManager">
                  <ref bean="org.fcrepo.server.storage.DOManager" />
              </property>
        </bean>
        <bean id="org.fcrepo.server.security.TestAttributeFinderModule"
              class="org.fcrepo.server.security.TestAttributeFinderModule"
              factory-method="getInstance" autowire-candidate="true">
        </bean>
         
         <bean id="org.fcrepo.server.security.PDPConfigurationFactory"
               class="org.fcrepo.server.security.impl.LegacyPDPConfigurationFactory">
             <constructor-arg><ref bean="org.fcrepo.server.Server" /></constructor-arg>
             <constructor-arg><ref bean="org.fcrepo.server.storage.DOManager" /></constructor-arg>
             <constructor-arg><ref bean="org.fcrepo.server.security.AuthorizationConfiguration" /></constructor-arg>
             <property name="attributeFinderModules">
                 <list>
                     <ref bean="org.fcrepo.server.security.ResourceAttributeFinderModule" />
                     <ref bean="org.fcrepo.server.security.ContextAttributeFinderModule" />
                     <ref bean="org.fcrepo.server.security.TestAttributeFinderModule" />
                 </list>
             </property>
              <property name="policyStrategy">
                <bean id="override-by-id" class="org.fcrepo.server.security.impl.OverridingPolicyStrategy">
                  <constructor-arg>
                    <ref bean="org.fcrepo.server.storage.DOManager" />
                  </constructor-arg>
                  <property name="override" value="ID" />
                </bean>
              </property>
         </bean>
         
        <bean id="org.fcrepo.server.security.PolicyEnforcementPoint"
              class="org.fcrepo.server.security.impl.PolicyEnforcementPoint"
              factory-method="getInstance" autowire-candidate="true">
              <property name="contextRegistry">
                <ref bean="org.fcrepo.security.ContextRegistry" />
              </property>
              <property name="PDPConfig">
                <bean factory-bean="org.fcrepo.server.security.PDPConfigurationFactory" factory-method="getDefaultPDPConfig" />
              </property>
              <property name="legacyConfiguration">
                <ref bean="org.fcrepo.server.security.AuthorizationConfiguration" />
              </property>
        </bean>
</beans>